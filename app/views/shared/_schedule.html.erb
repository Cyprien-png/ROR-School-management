<%# 
  Schedule component for displaying lectures in a weekly timetable
  Usage: 
  <%= render 'shared/schedule', lectures: @lectures, days: ["monday", "tuesday", "wednesday", "thursday", "friday"] %>
%>

<% 
  # Default days if not provided
  days = local_assigns.fetch(:days, ["monday", "tuesday", "wednesday", "thursday", "friday"])
  
  # Group lectures by day
  lectures_by_day = {}
  days.each do |day|
    lectures_by_day[day] = local_assigns.fetch(:lectures, []).select { |l| l.week_day == day }.sort_by(&:start_time)
  end
%>

<div class="overflow-x-auto">
  <div class="min-w-full grid grid-cols-<%= days.size %> gap-4">
    <% days.each_with_index do |day, index| %>
      <div class="flex flex-col">
        <div class="bg-indigo-600 text-white text-center py-3 font-semibold rounded-t-lg">
          <%= day.capitalize %>
        </div>
        <div class="bg-white rounded-b-lg shadow-md flex-grow min-h-[300px] p-2">
          <% if lectures_by_day[day].any? %>
            <% lectures_by_day[day].each do |lecture| %>
              <div class="mb-2 p-2 rounded-lg bg-green-50 border border-green-200 shadow-sm hover:shadow-md transition-shadow duration-200">
                <div class="font-semibold text-green-800"><%= lecture.subject.name %></div>
                <div class="text-sm text-gray-600">
                  <%= lecture.start_time.strftime("%H:%M") %> - <%= lecture.end_time.strftime("%H:%M") %>
                </div>
                <div class="text-sm text-gray-600">
                  <%= lecture.school_class.name %>
                </div>
                <div class="text-xs text-gray-500 mt-1">
                  <%= "#{lecture.teacher.firstname} #{lecture.teacher.lastname}" %>
                </div>
              </div>
            <% end %>
          <% else %>
            <div class="text-center text-gray-400 italic text-sm py-4">
              No lectures
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div> 