<p style="color: green"><%= notice %></p>

<% content_for :title, "Subjects" %>

<div class="space-y-6">
  <div class="flex justify-between items-center">
    <h1 class="text-2xl font-bold">Academic Subjects</h1>
    <% if current_person.is_a?(Dean) %>
      <%= render 'shared/button', 
        text: "New Subject", 
        icon: "fa-solid fa-plus",
        color: "purple", 
        href: new_subject_path %>
    <% end %>
  </div>

  <%= render 'shared/card', 
    title: "All Subjects", 
    color: "purple", 
    icon: "fa-solid fa-book",
    content: capture do %>
    
    <%= render 'shared/table', headers: ["Name", "Teachers", current_person.is_a?(Dean) ? "Actions" : nil].compact, striped: true do %>
      <% @subjects.each do |subject| %>
        <tr>
          <td class="px-6 py-4 whitespace-nowrap font-medium"><%= subject.name %></td>
          <td class="px-6 py-4">
            <% if subject.teachers.any? %>
              <div class="flex flex-wrap gap-2">
                <% subject.teachers.each do |teacher| %>
                  <%= render 'shared/badge', 
                    text: "#{teacher.firstname} #{teacher.lastname}", 
                    color: "green", 
                    size: "sm" %>
                <% end %>
              </div>
            <% else %>
              <span class="text-gray-500 italic">No teachers assigned</span>
            <% end %>
          </td>
          <% if current_person.is_a?(Dean) %>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex space-x-2">
                <%= render 'shared/button', 
                  text: "View", 
                  icon: "fa-solid fa-eye",
                  color: "outline-purple", 
                  size: "sm",
                  href: subject_path(subject) %>
                  
                <%= render 'shared/button', 
                  text: "Edit", 
                  icon: "fa-solid fa-pencil",
                  color: "outline-indigo", 
                  size: "sm",
                  href: edit_subject_path(subject) %>
                  
                <%= render 'shared/button', 
                  text: "Delete", 
                  icon: "fa-solid fa-trash",
                  color: "outline-red", 
                  size: "sm",
                  method: :delete,
                  confirm: "Are you sure you want to delete this subject?",
                  href: subject_path(subject) %>
              </div>
            </td>
          <% end %>
        </tr>
      <% end %>
    <% end %>
  <% end %>
</div>
