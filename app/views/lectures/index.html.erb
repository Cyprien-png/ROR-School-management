<p style="color: green"><%= notice %></p>

<% content_for :title, "Lectures Schedule" %>

<div class="space-y-6">
  <div class="flex justify-between items-center">
    <h1 class="text-2xl font-bold">Lectures Schedule</h1>
    <% if current_person.is_a?(Dean) %>
      <%= render 'shared/button', 
        text: "New Lecture", 
        icon: "fa-solid fa-plus",
        color: "green", 
        href: new_lecture_path %>
    <% end %>
  </div>

  <div class="overflow-hidden rounded-lg border border-green-200 shadow-sm mb-6">
    <div class="bg-green-50 px-4 py-5 sm:px-6 flex items-center">
      <i class="fa-solid fa-calendar-days mr-3 text-xl"></i>
      <h3 class="text-lg font-medium leading-6 text-green-700">
        Weekly Schedule
      </h3>
    </div>
    <div class="border-t border-gray-200 bg-white px-4 py-5 sm:p-6">
      <div class="overflow-x-auto">
        <div class="min-w-full grid grid-cols-<%= ["monday", "tuesday", "wednesday", "thursday", "friday"].size %> gap-4">
          <% ["monday", "tuesday", "wednesday", "thursday", "friday"].each_with_index do |day, index| %>
            <div class="flex flex-col">
              <div class="py-3 font-semibold text-center text-white bg-indigo-600 rounded-t-lg">
                <%= day.capitalize %>
              </div>
              <div class="bg-white rounded-b-lg shadow-md flex-grow min-h-[300px] p-2">
                <% day_lectures = @lectures.select { |l| l.week_day == day }.sort_by(&:start_time) %>
                <% if day_lectures.any? %>
                  <% day_lectures.each do |lecture| %>
                    <div class="p-2 mb-2 bg-green-50 rounded-lg border border-green-200 shadow-sm transition-shadow duration-200 hover:shadow-md">
                      <div class="font-semibold text-green-800"><%= lecture.subject.name %></div>
                      <div class="text-sm text-gray-600">
                        <%= lecture.start_time.strftime("%H:%M") %> - <%= lecture.end_time.strftime("%H:%M") %>
                      </div>
                      <div class="text-sm text-gray-600">
                        <%= lecture.school_class.name %>
                      </div>
                      <div class="mt-1 text-xs text-gray-500">
                        <%= "#{lecture.teacher.firstname} #{lecture.teacher.lastname}" %>
                      </div>
                    </div>
                  <% end %>
                <% else %>
                  <div class="py-4 text-sm italic text-center text-gray-400">
                    No lectures
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="overflow-hidden rounded-lg border border-green-200 shadow-sm mb-6">
    <div class="bg-green-50 px-4 py-5 sm:px-6 flex items-center">
      <i class="fa-solid fa-list mr-3 text-xl"></i>
      <h3 class="text-lg font-medium leading-6 text-green-700">
        All Lectures
      </h3>
    </div>
    <div class="border-t border-gray-200 bg-white px-4 py-5 sm:p-6">
      <div class="overflow-x-auto shadow-md sm:rounded-lg">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <% ["Subject", "Class", "Teacher", "Day", "Time", "Actions"].each do |header| %>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  <%= header %>
                </th>
              <% end %>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            <% @lectures.each_with_index do |lecture, index| %>
              <tr class="<%= index.odd? ? 'bg-gray-50' : '' %>">
                <td class="px-6 py-4 whitespace-nowrap font-medium"><%= lecture.subject.name %></td>
                <td class="px-6 py-4 whitespace-nowrap"><%= lecture.school_class.name %></td>
                <td class="px-6 py-4 whitespace-nowrap"><%= "#{lecture.teacher.firstname} #{lecture.teacher.lastname}" %></td>
                <td class="px-6 py-4 whitespace-nowrap"><%= lecture.week_day.capitalize %></td>
                <td class="px-6 py-4 whitespace-nowrap"><%= lecture.start_time.strftime("%H:%M") %> - <%= lecture.end_time.strftime("%H:%M") %></td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex space-x-2">
                    <%= render 'shared/button', 
                      text: "View", 
                      icon: "fa-solid fa-eye",
                      color: "outline-green", 
                      size: "sm",
                      href: lecture_path(lecture) %>
                      
                    <% if current_person.is_a?(Dean) %>
                      <%= render 'shared/button', 
                        text: "Edit", 
                        icon: "fa-solid fa-pencil",
                        color: "outline-indigo", 
                        size: "sm",
                        href: edit_lecture_path(lecture) %>
                        
                      <%= render 'shared/button', 
                        text: "Delete", 
                        icon: "fa-solid fa-trash",
                        color: "outline-red", 
                        size: "sm",
                        method: :delete,
                        confirm: "Are you sure you want to delete this lecture?",
                        href: lecture_path(lecture) %>
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
